# Улучшенная система тегирования

В этом обновлении добавлена расширенная система интеллектуального тегирования, которая значительно улучшает классификацию и тематическое моделирование разговоров.

## Новые возможности

1. **Классификация по категориям** - автоматическое определение предметной области разговора:

   - Бизнес
   - Техническое
   - Образование
   - Личное
   - Планирование
   - Отчёт
   - и другие

2. **Определение назначения разговора**:

   - Брейншторм
   - Обсуждение проблемы
   - Планирование
   - Принятие решения
   - Информирование
   - Обучение
   - Обратная связь

3. **Тематическое моделирование** - автоматическое выделение ключевых тем разговора с использованием методов машинного обучения.

4. **Улучшенная нормализация русских слов** - с использованием морфологического анализатора PyMorphy2.

## Совместимость и установка

Система тегирования совместима с Python 3.13 и выше благодаря специальным исправлениям для работы с новыми версиями библиотек.

### Установка в виртуальное окружение

```bash
# Создание виртуального окружения
python -m venv venv

# Активация виртуального окружения
# Для Linux/Mac
source venv/bin/activate
# Для Windows
# venv\Scripts\activate

# Установка зависимостей
pip install -r requirements.txt

# Загрузка стоп-слов для NLTK
python -c "import nltk; nltk.download('stopwords')"
```

## Обновление тегов в существующих транскрипциях

Чтобы обновить теги во всех существующих транскрипциях, запустите скрипт:

```bash
python backend/update_tags.py
```

Для принудительного обновления всех тегов (даже если они уже существуют):

```bash
python backend/update_tags.py --force
```

## Новая структура тегов

Теперь в JSON-файлах с транскрипциями доступны следующие поля:

```json
{
  "text": "Текст транскрипции...",
  "tags": ["ключевое", "слово", "тег"],
  "keyphrases": ["ключевая фраза", "важная концепция"],
  "categories": ["техническое", "планирование"],
  "topics": ["тема разговора определенная алгоритмом"],
  "purpose": "обсуждение проблемы",
  "purpose_details": {
    "main_purpose": "обсуждение проблемы",
    "purpose_probabilities": {
      "брейншторм": 10.5,
      "обсуждение проблемы": 65.2,
      "планирование": 24.3,
      "принятие решения": 0,
      "...": "..."
    }
  }
}
```

## Расширение системы

Вы можете расширить словари для классификации, добавив новые ключевые слова и фразы в файле `backend/tagging.py`:

- `CATEGORIES` - словарь категорий и связанных с ними ключевых слов
- `PURPOSE_INDICATORS` - словарь назначений разговора и связанных с ними фраз

## Возможные проблемы и их решение

1. **Ошибка с PyMorphy2**: Если при запуске вы видите ошибку, связанную с `inspect.getargspec`, это может быть вызвано несовместимостью с более новой версией Python. Наша система должна автоматически обрабатывать это, но если проблема не решается, попробуйте использовать Python 3.8-3.12.

2. **Отсутствуют стоп-слова NLTK**: Если при первом запуске вы видите предупреждение о недоступности стоп-слов, выполните:

   ```bash
   python -c "import nltk; nltk.download('stopwords')"
   ```

3. **Ошибка с scikit-learn**: Если вы видите ошибки в тематическом моделировании, убедитесь, что у вас установлена последняя версия scikit-learn и обновите её при необходимости:
   ```bash
   pip install --upgrade scikit-learn
   ```

## Примечания

- Для полноценной работы тематического моделирования текст транскрипции должен содержать не менее 200 символов.
- Качество определения назначения и категорий зависит от словарей ключевых слов/фраз и может требовать настройки под конкретные задачи.
